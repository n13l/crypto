#include <hpc/compiler.h>
#include <inttypes.h>

#if defined(__aarch64__)
extern void KeccakF1600_hw(uint64_t st[25]);

static inline void
keccakf1600(uint64_t st[25])
{
	KeccakF1600_hw(st);
}
#elif defined(__x86_64__)
extern void sha3_keccak_f1600(uint64_t a[25], const uint64_t rc[24]);

static const uint64_t keccakf1600_rndc[24] = {
	0x0000000000000001ULL, 0x0000000000008082ULL, 0x800000000000808aULL,
	0x8000000080008000ULL, 0x000000000000808bULL, 0x0000000080000001ULL,
	0x8000000080008081ULL, 0x8000000000008009ULL, 0x000000000000008aULL,
	0x0000000000000088ULL, 0x0000000080008009ULL, 0x000000008000000aULL,
	0x000000008000808bULL, 0x800000000000008bULL, 0x8000000000008089ULL,
	0x8000000000008003ULL, 0x8000000000008002ULL, 0x8000000000000080ULL,
	0x000000000000800aULL, 0x800000008000000aULL, 0x8000000080008081ULL,
	0x8000000000008080ULL, 0x0000000080000001ULL, 0x8000000080008008ULL
};

static inline void
keccakf1600(uint64_t st[25])
{
	sha3_keccak_f1600(st, keccakf1600_rndc);
}
#else
#error "CONFIG_CRYPTO_SHA3_ASM: unsupported architecture"
#endif
