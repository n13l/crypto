menu "Digest algorithms"

config CRYPTO_SHA3
	bool

config CRYPTO_SHA3_NULL
	bool

config CRYPTO_SHA3_OSSL
	bool

config CRYPTO_SHA3_ASM
	bool

choice
	prompt "SHA-3 implementation"
	depends on !MODULES
	default CRYPTO_SHA3_SEL_ASM if CRYPTO_VERIFIED
	default CRYPTO_SHA3_SEL_NULL
	help
	  Select the SHA-3 digest implementation to use. Only one
	  implementation can be active at a time.

config CRYPTO_SHA3_SEL_NULL
	bool "None"
	select CRYPTO_SHA3_NULL
	help
	  Do not include SHA-3 support.

config CRYPTO_SHA3_SEL_C
	bool "SHA-3 (generic C)"
	depends on !MODULES && !CRYPTO_VERIFIED
	select CRYPTO_SHA3
	help
	  SHA-3 secure hash standard (FIPS 202) plain C implementation.

config CRYPTO_SHA3_SEL_OSSL
	bool "SHA-3 (assembly, OpenSSL)"
	depends on !MODULES && !CRYPTO_VERIFIED
	select CRYPTO_SHA3_OSSL
	help
	  SHA-3 Keccak-f[1600] using OpenSSL's platform-optimized C
	  implementation.

config CRYPTO_SHA3_SEL_ASM
	bool "SHA-3 (assembly, aws-lc)"
	depends on !MODULES
	depends on SRCARCH = "arm64" || SRCARCH = "x86"
	select CRYPTO_SHA3_ASM
	help
	  SHA-3 Keccak-f[1600] permutation using optimized assembly
	  from aws-lc.

endchoice

comment "SHA-3 modules (Y=built-in, M=module, N=disabled)"
	depends on MODULES

config CRYPTO_SHA3_DYN_C
	tristate "SHA-3 (generic C)"
	depends on MODULES && !CRYPTO_VERIFIED
	default m
	help
	  SHA-3 secure hash standard (FIPS 202) plain C implementation.

config CRYPTO_SHA3_DYN_OSSL
	tristate "SHA-3 (assembly, OpenSSL)"
	depends on MODULES && !CRYPTO_VERIFIED
	default m
	help
	  SHA-3 Keccak-f[1600] using OpenSSL's platform-optimized C
	  implementation.

config CRYPTO_SHA3_DYN_ASM
	tristate "SHA-3 (assembly, aws-lc)"
	depends on MODULES
	depends on SRCARCH = "arm64" || SRCARCH = "x86"
	default m
	help
	  SHA-3 Keccak-f[1600] permutation using optimized assembly
	  from aws-lc.

config CRYPTO_SHA1_NULL
	bool

config CRYPTO_SHA1_OSSL
	bool

config CRYPTO_SHA1_ASM
	bool

choice
	prompt "SHA-1 implementation"
	depends on !MODULES
	default CRYPTO_SHA1_SEL_ASM if CRYPTO_VERIFIED
	default CRYPTO_SHA1_SEL_OSSL
	help
	  Select the SHA-1 digest implementation to use.

config CRYPTO_SHA1_SEL_NULL
	bool "None"
	select CRYPTO_SHA1_NULL
	help
	  Do not include SHA-1 support.

config CRYPTO_SHA1_SEL_OSSL
	bool "SHA-1 (assembly, OpenSSL)"
	depends on !MODULES
	depends on SRCARCH = "arm64" || SRCARCH = "x86"
	select CRYPTO_SHA1_OSSL
	help
	  SHA-1 using OpenSSL's platform-optimized assembly.

config CRYPTO_SHA1_SEL_ASM
	bool "SHA-1 (assembly, aws-lc)"
	depends on !MODULES
	depends on SRCARCH = "arm64" || SRCARCH = "x86"
	select CRYPTO_SHA1_ASM
	help
	  SHA-1 using optimized assembly from aws-lc.

endchoice

comment "SHA-1 modules (Y=built-in, M=module, N=disabled)"
	depends on MODULES

config CRYPTO_SHA1_DYN_OSSL
	tristate "SHA-1 (assembly, OpenSSL)"
	depends on MODULES
	depends on SRCARCH = "arm64" || SRCARCH = "x86"
	default n
	help
	  SHA-1 using OpenSSL's platform-optimized assembly.

config CRYPTO_SHA1_DYN_ASM
	tristate "SHA-1 (assembly, aws-lc)"
	depends on MODULES
	depends on SRCARCH = "arm64" || SRCARCH = "x86"
	default n
	help
	  SHA-1 using optimized assembly from aws-lc.

config CRYPTO_SHA2_NULL
	bool

config CRYPTO_SHA2_OSSL
	bool

config CRYPTO_SHA2_ASM
	bool

choice
	prompt "SHA-2 implementation"
	depends on !MODULES
	default CRYPTO_SHA2_SEL_ASM if CRYPTO_VERIFIED
	default CRYPTO_SHA2_SEL_OSSL
	help
	  Select the SHA-2 (SHA-256/SHA-512) digest implementation to use.

config CRYPTO_SHA2_SEL_NULL
	bool "None"
	select CRYPTO_SHA2_NULL
	help
	  Do not include SHA-2 support.

config CRYPTO_SHA2_SEL_OSSL
	bool "SHA-2 (assembly, OpenSSL)"
	depends on !MODULES
	depends on SRCARCH = "arm64" || SRCARCH = "x86"
	select CRYPTO_SHA2_OSSL
	help
	  SHA-256/SHA-512 using OpenSSL's platform-optimized assembly.

config CRYPTO_SHA2_SEL_ASM
	bool "SHA-2 (assembly, aws-lc)"
	depends on !MODULES
	depends on SRCARCH = "arm64" || SRCARCH = "x86"
	select CRYPTO_SHA2_ASM
	help
	  SHA-256/SHA-512 using optimized assembly from aws-lc.

endchoice

comment "SHA-2 modules (Y=built-in, M=module, N=disabled)"
	depends on MODULES

config CRYPTO_SHA2_DYN_OSSL
	tristate "SHA-2 (assembly, OpenSSL)"
	depends on MODULES
	depends on SRCARCH = "arm64" || SRCARCH = "x86"
	default m
	help
	  SHA-256/SHA-512 using OpenSSL's platform-optimized assembly.

config CRYPTO_SHA2_DYN_ASM
	tristate "SHA-2 (assembly, aws-lc)"
	depends on MODULES
	depends on SRCARCH = "arm64" || SRCARCH = "x86"
	default m
	help
	  SHA-256/SHA-512 using optimized assembly from aws-lc.

endmenu
